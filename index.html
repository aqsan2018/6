<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Whack-a-Love-Mole!</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Pacifico', cursive;
      background-color: #fce7f3;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      overflow: hidden;
      flex-direction: column;
    }

    #game-area {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
      gap: 1rem;
      background-color: #fbcfe8;
      padding: 1rem;
      border-radius: 2rem;
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
      position: relative;
      margin-bottom: 2rem;
      width: 300px;
      height: 300px;
    }

    @media (min-width: 640px) {
      #game-area {
        gap: 1.5rem;
        padding: 1.5rem;
        width: 350px;
        height: 350px;
      }
    }

    .hole {
      width: 100%;
      height: 100%;
      background-color: #e9d5ff;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      box-shadow: inset 0 5px 10px rgba(0,0,0,0.2);
    }

    .mole {
      position: absolute;
      bottom: -100px;
      transition: bottom 0.2s ease-out;
      cursor: pointer;
      user-select: none;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .mole.up {
      bottom: 5px;
    }

    .mole.hit {
      animation: hit-animation 0.2s ease-out;
      opacity: 0;
    }

    @keyframes hit-animation {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.8; }
      100% { transform: scale(0.8); opacity: 0; }
    }

    #score-board {
      background-color: #fff;
      padding: 1rem 2rem;
      border-radius: 1.5rem;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      margin-bottom: 1.5rem;
      display: flex;
      gap: 2rem;
      font-size: 1.8rem;
      color: #be185d;
    }

    #game-over-screen {
      background-color: rgba(255, 255, 255, 0.95);
      z-index: 200;
    }

    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      background-color: #f0f;
      animation: confetti-fall 2s linear forwards;
      pointer-events: none;
      border-radius: 50%;
      opacity: 0;
      z-index: 199;
    }

    @keyframes confetti-fall {
      0% { transform: translateY(-10vh) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
    }

    .rain {
      position: fixed;
      top: -10vh;
      font-size: 2rem;
      pointer-events: none;
      user-select: none;
      animation: fall 5s linear forwards;
      z-index: 300;
    }

    @keyframes fall {
      0% { transform: translateY(0vh); opacity: 1; }
      100% { transform: translateY(110vh); opacity: 1; }
    }

    .bomb-effect {
      position: fixed;
      font-size: 3rem;
      animation: bomb-pop 0.5s ease-out forwards;
      pointer-events: none;
      z-index: 400;
    }

    @keyframes bomb-pop {
      0% { transform: scale(0.5); opacity: 1; }
      50% { transform: scale(1.5); opacity: 0.8; }
      100% { transform: scale(1.2); opacity: 0; }
    }
  </style>
</head>

<body class="overflow-hidden">
  <div id="score-board">
    <div>Score: <span id="score">0</span></div>
    <div>Time: <span id="time">30</span>s</div>
  </div>

  <div id="game-area"></div>

  <button id="start-button" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-8 rounded-full shadow-lg text-2xl mt-8">
    Start Game!
  </button>

  <div id="game-over-screen" class="hidden absolute inset-0 flex-col items-center justify-center text-center p-6">
    <h1 id="final-message" class="text-5xl text-purple-700 mb-4"></h1>
    <img id="result-gif" src="" alt="Result GIF" class="w-48 h-48 mx-auto rounded-lg mb-6">
    <p id="final-score" class="text-3xl text-gray-700 mb-6"></p>
    <button id="play-again-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-full shadow-lg text-2xl">
      Play Again!
    </button>
  </div>

  <audio id="good-sound" src="good_sound.mp3"></audio>
  <audio id="bad-sound" src="bad_sound.mp3"></audio>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const gameArea = document.getElementById('game-area');
      const scoreSpan = document.getElementById('score');
      const timeSpan = document.getElementById('time');
      const startButton = document.getElementById('start-button');
      const gameOverScreen = document.getElementById('game-over-screen');
      const finalMessage = document.getElementById('final-message');
      const resultGif = document.getElementById('result-gif');
      const finalScoreDisplay = document.getElementById('final-score');
      const playAgainButton = document.getElementById('play-again-button');
      const goodSound = document.getElementById('good-sound');
      const badSound = document.getElementById('bad-sound');

      let score = 0;
      let time = 30;
      let timerId;
      let molePopTimerId;
      let lastHole;
      let gameStarted = false;
      let rainInterval;

      const goodImages = ["good-mole.png", "heart.png", "flower.png"];
      const badImages = ["bad-mole.png"];

      const holes = [];

      function createHoles() {
        for (let i = 0; i < 9; i++) {
          const holeDiv = document.createElement('div');
          holeDiv.classList.add('hole');

          const moleDiv = document.createElement('div');
          moleDiv.classList.add('mole');
          moleDiv.addEventListener('click', whack);

          holeDiv.appendChild(moleDiv);
          gameArea.appendChild(holeDiv);
          holes.push(holeDiv);
        }
      }

      function randomHole(currentHoles) {
        const idx = Math.floor(Math.random() * currentHoles.length);
        const hole = currentHoles[idx];
        if (hole === lastHole) return randomHole(currentHoles);
        lastHole = hole;
        return hole;
      }

      function randomTime(min, max) {
        return Math.round(Math.random() * (max - min) + min);
      }

      function popUpMole() {
        if (!gameStarted) return;
        const hole = randomHole(holes);
        const mole = hole.querySelector('.mole');

        const isBadMole = Math.random() < 0.25;
        const type = isBadMole ? 'bad' : 'good';
        const imageName = isBadMole
          ? badImages[Math.floor(Math.random() * badImages.length)]
          : goodImages[Math.floor(Math.random() * goodImages.length)];

        mole.innerHTML = `<img src="${imageName}" alt="${type}" class="mole-image w-16 h-16 sm:w-20 sm:h-20 pointer-events-none" onerror="this.style.display='none'">`;
        mole.dataset.type = type;
        mole.classList.remove('hit');
        mole.classList.add('up');

        const popTime = randomTime(800, 1500);
        setTimeout(() => {
          mole.classList.remove('up');
          mole.innerHTML = '';
          if (gameStarted) {
            molePopTimerId = setTimeout(popUpMole, randomTime(1000, 1800));
          }
        }, popTime);
      }

      function startGame() {
        score = 0;
        time = 30;
        gameStarted = true;
        scoreSpan.textContent = score;
        timeSpan.textContent = time;
        gameOverScreen.classList.add('hidden');
        startButton.classList.add('hidden');

        gameArea.querySelectorAll('.mole').forEach(mole => {
          mole.classList.remove('up', 'hit');
          mole.innerHTML = '';
        });

        popUpMole();
        timerId = setInterval(countdown, 1000);
      }

      function countdown() {
        time--;
        timeSpan.textContent = time;
        if (time <= 0) {
          clearInterval(timerId);
          clearTimeout(molePopTimerId);
          gameStarted = false;
          endGame();
        }
      }

      function whack(event) {
        if (!gameStarted || !event.isTrusted) return;
        const mole = event.target.closest('.mole');
        if (!mole || !mole.classList.contains('up')) return;

        mole.classList.remove('up');
        mole.classList.add('hit');

        if (mole.dataset.type === 'good') {
          score++;
          goodSound.play();
          createConfetti();
        } else {
          score = Math.max(0, score - 5);
          badSound.play();
          createBombEffect(event.clientX, event.clientY);
        }

        scoreSpan.textContent = score;
      }

      function endGame() {
        gameOverScreen.classList.remove('hidden');
        finalScoreDisplay.textContent = `Your Score: ${score}`;

        if (rainInterval) clearInterval(rainInterval);

        if (score >= 5) {
          finalMessage.textContent = "Dammee Tompleteed!";
          resultGif.src = "kiss.gif";
          rainInterval = setInterval(() => createRain('❤️'), 200);
        } else {
          finalMessage.textContent = "Naap Naap, try again!";
          resultGif.src = "cry.gif";
          rainInterval = setInterval(() => createRain('😭'), 200);
        }
      }

      function createConfetti() {
        for (let i = 0; i < 15; i++) {
          const confetti = document.createElement('div');
          confetti.classList.add('confetti');
          confetti.style.left = `${Math.random() * 100}vw`;
          confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`;
          confetti.style.animationDelay = `${Math.random() * 0.5}s`;
          document.body.appendChild(confetti);
          setTimeout(() => confetti.remove(), 2000);
        }
      }

      function createRain(emoji) {
        const rain = document.createElement('div');
        rain.classList.add('rain');
        rain.textContent = emoji;
        rain.style.left = `${Math.random() * 100}vw`;
        rain.style.animationDuration = `${Math.random() * 2 + 3}s`;
        document.body.appendChild(rain);
        setTimeout(() => rain.remove(), 5000);
      }

      function createBombEffect(x, y) {
        const bomb = document.createElement('div');
        bomb.classList.add('bomb-effect');
        bomb.textContent = '💣';
        bomb.style.left = `${x - 24}px`;
        bomb.style.top = `${y - 24}px`;
        document.body.appendChild(bomb);
        setTimeout(() => bomb.remove(), 500);
      }

      startButton.addEventListener('click', startGame);
      playAgainButton.addEventListener('click', () => {
        gameOverScreen.classList.add('hidden');
        startButton.classList.remove('hidden');
        if (rainInterval) clearInterval(rainInterval);
        document.querySelectorAll('.rain').forEach(el => el.remove());
      });

      createHoles();
    });
  </script>
</body>
</html>
